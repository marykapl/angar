<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Склад одежды | Госуслуги</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Общие стили в стиле Госуслуг */
        :root {
            --primary-color: #1e6bb8;
            --primary-dark: #155a9c;
            --secondary-color: #f5f5f5;
            --accent-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --text-primary: #333333;
            --text-secondary: #666666;
            --border-color: #dddddd;
            --card-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            --header-height: 60px;
            --footer-height: 70px;
            --max-width: 800px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Roboto', 'Arial', sans-serif;
        }

        body {
            background-color: #f8f9fa;
            color: var(--text-primary);
            line-height: 1.5;
            max-width: var(--max-width);
            margin: 0 auto;
            min-height: 100vh;
            position: relative;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
        }

        /* Шапка приложения */
        .app-header {
            background-color: white;
            height: var(--header-height);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--card-shadow);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            color: var(--primary-color);
            font-size: 24px;
        }

        .logo-text {
            font-weight: 600;
            font-size: 18px;
            color: var(--primary-color);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        /* Основной контент */
        .app-content {
            padding: 16px;
            min-height: calc(100vh - var(--header-height) - var(--footer-height));
            padding-bottom: 100px;
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Карточки в стиле Госуслуг */
        .card {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: var(--card-shadow);
            border-left: 4px solid var(--primary-color);
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--primary-color);
        }

        /* Формы */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-control {
            width: 100%;
            padding: 14px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* Кнопки */
        .btn {
            display: inline-block;
            padding: 14px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            width: 100%;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: white;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background-color: #f0f7ff;
        }

        .btn-success {
            background-color: var(--accent-color);
            color: white;
        }

        .btn-success:hover {
            background-color: #3d8b40;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .btn-warning:hover {
            background-color: #e68a00;
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        /* Навигация */
        .app-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            height: var(--footer-height);
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-top: 1px solid var(--border-color);
            z-index: 100;
            max-width: var(--max-width);
            margin: 0 auto;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.2s;
            flex: 1;
            height: 100%;
        }

        .nav-item.active {
            color: var(--primary-color);
            background-color: #f0f7ff;
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .nav-text {
            font-size: 12px;
            font-weight: 500;
        }

        /* Страница входа */
        .login-container {
            max-width: 400px;
            margin: 40px auto;
        }

        .login-logo {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary-color);
        }

        .login-logo i {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .login-logo h1 {
            font-size: 24px;
            font-weight: 600;
        }

        /* Страница инвентаря */
        .inventory-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-select {
            flex: 1;
            min-width: 150px;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 16px;
            background-color: white;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 16px;
        }

        .inventory-item {
            background-color: white;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            box-shadow: var(--card-shadow);
            transition: transform 0.2s;
            border: 1px solid var(--border-color);
        }

        .inventory-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .item-name {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .item-size {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 8px;
        }

        .item-quantity {
            font-weight: 600;
            font-size: 20px;
            color: var(--primary-color);
        }

        .item-quantity.low {
            color: var(--warning-color);
        }

        .item-quantity.out {
            color: var(--danger-color);
        }

        /* Страница выбора */
        .selection-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .selection-controls .btn {
            flex: 1;
        }

        .cart-items {
            margin-bottom: 20px;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background-color: white;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 4px solid var(--primary-color);
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .cart-item-details {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .quantity-value {
            min-width: 20px;
            text-align: center;
            font-weight: 600;
        }

        /* Страница записи */
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 24px;
        }

        .calendar-header {
            text-align: center;
            font-weight: 600;
            padding: 8px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .calendar-day {
            text-align: center;
            padding: 12px 4px;
            background-color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .calendar-day:hover {
            background-color: #f0f7ff;
        }

        .calendar-day.selected {
            background-color: var(--primary-color);
            color: white;
        }

        .calendar-day.disabled {
            color: var(--border-color);
            cursor: not-allowed;
            background-color: #f9f9f9;
        }

        .time-slots {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .time-slot {
            padding: 12px;
            text-align: center;
            background-color: white;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }

        .time-slot:hover {
            background-color: #f0f7ff;
        }

        .time-slot.selected {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .time-slot.disabled {
            color: var(--border-color);
            cursor: not-allowed;
            background-color: #f9f9f9;
        }

        /* Утилиты */
        .text-center {
            text-align: center;
        }

        .mt-4 {
            margin-top: 24px;
        }

        .mb-4 {
            margin-bottom: 24px;
        }

        .hidden {
            display: none;
        }

        .alert {
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background-color: #e8f5e9;
            color: #2e7d32;
            border-left: 4px solid var(--accent-color);
        }

        .alert-info {
            background-color: #e3f2fd;
            color: var(--primary-color);
            border-left: 4px solid var(--primary-color);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }

        .status-new {
            background-color: #e8f5e9;
            color: #2e7d32;
        }

        .status-replacement {
            background-color: #fff3e0;
            color: #ef6c00;
        }

        /* Адаптивность */
        @media (max-width: 600px) {
            .inventory-grid {
                grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            }

            .time-slots {
                grid-template-columns: repeat(2, 1fr);
            }

            .selection-controls {
                flex-direction: column;
            }
        }

        @media (max-width: 400px) {
            .inventory-grid {
                grid-template-columns: 1fr 1fr;
            }

            .time-slots {
                grid-template-columns: 1fr;
            }

            .app-content {
                padding: 12px;
            }
        }
    </style>
</head>
<body>
<!-- Шапка приложения -->
<header class="app-header">
    <div class="logo-container">
        <i class="fas fa-tshirt logo-icon"></i>
        <div class="logo-text">Склад одежды</div>
    </div>
    <div class="user-info hidden" id="userInfo">
        <div class="user-avatar" id="userAvatar">ИИ</div>
        <span id="userName">Иван Иванов</span>
    </div>
</header>

<!-- Основной контент -->
<main class="app-content">
    <!-- Страница авторизации -->
    <div class="page active" id="loginPage">
        <div class="login-container">
            <div class="login-logo">
                <i class="fas fa-tshirt"></i>
                <h1>Склад одежды</h1>
                <p>Оформление заявок на получение одежды</p>
            </div>

            <div class="card">
                <h2 class="card-title"><i class="fas fa-sign-in-alt"></i> Вход в систему</h2>

                <div class="form-group">
                    <label class="form-label" for="login">Логин</label>
                    <input type="text" class="form-control" id="login" placeholder="Введите логин">
                </div>

                <div class="form-group">
                    <label class="form-label" for="password">Пароль</label>
                    <input type="password" class="form-control" id="password" placeholder="Введите пароль">
                </div>

                <button class="btn btn-primary" id="loginBtn">Войти</button>

                <div class="text-center mt-4">
                    <p>Для демонстрации используйте:</p>
                    <p><strong>Логин:</strong> user | <strong>Пароль:</strong> 123</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Страница наличия одежды -->
    <div class="page" id="inventoryPage">
        <div class="card">
            <h2 class="card-title"><i class="fas fa-boxes"></i> Наличие одежды на складе</h2>

            <div class="inventory-filters">
                <select class="filter-select" id="categoryFilter">
                    <option value="">Все категории</option>
                    <option value="Верхняя одежда">Верхняя одежда</option>
                    <option value="Спецодежда">Спецодежда</option>
                    <option value="Форма">Форма</option>
                    <option value="Обувь">Обувь</option>
                </select>

                <select class="filter-select" id="sizeFilter">
                    <option value="">Все размеры</option>
                    <option value="S">S</option>
                    <option value="M">M</option>
                    <option value="L">L</option>
                    <option value="XL">XL</option>
                    <option value="42">42</option>
                    <option value="44">44</option>
                </select>
            </div>

            <div class="inventory-grid" id="inventoryGrid">
                <!-- Инвентарь будет загружен через JavaScript -->
            </div>
        </div>

        <div class="alert alert-info">
            <i class="fas fa-info-circle"></i> Для оформления заявки выберите одежду в разделе "Выбор"
        </div>
    </div>

    <!-- Страница выбора одежды -->
    <div class="page" id="selectionPage">
        <div class="card">
            <h2 class="card-title"><i class="fas fa-shopping-cart"></i> Выбор одежды</h2>

            <div class="selection-controls">
                <button class="btn btn-secondary" id="showInventoryBtn">
                    <i class="fas fa-boxes"></i> Наличие на складе
                </button>
                <button class="btn btn-primary" id="addItemBtn">
                    <i class="fas fa-plus"></i> Добавить
                </button>
            </div>

            <div class="form-group">
                <label class="form-label">Тип процедуры</label>
                <div class="selection-controls">
                    <button class="btn btn-secondary active" id="newBtn">
                        <i class="fas fa-plus-circle"></i> Получение новой
                    </button>
                    <button class="btn btn-secondary" id="replacementBtn">
                        <i class="fas fa-exchange-alt"></i> Замена
                    </button>
                </div>
            </div>

            <div id="cartItems" class="cart-items">
                <!-- Корзина будет заполняться через JavaScript -->
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i> Корзина пуста. Добавьте одежду из инвентаря.
                </div>
            </div>

            <button class="btn btn-success" id="toBookingBtn" disabled>
                <i class="fas fa-calendar-alt"></i> Перейти к записи
            </button>
        </div>
    </div>

    <!-- Страница записи на склад -->
    <div class="page" id="bookingPage">
        <div class="card">
            <h2 class="card-title"><i class="fas fa-calendar-alt"></i> Запись на склад</h2>

            <div class="form-group">
                <label class="form-label">Выберите дату посещения</label>
                <div class="calendar" id="calendar">
                    <!-- Календарь будет сгенерирован через JavaScript -->
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Выберите время посещения</label>
                <div class="time-slots" id="timeSlots">
                    <!-- Временные слоты будут сгенерированы через JavaScript -->
                </div>
            </div>

            <div id="bookingSummary" class="mb-4 hidden">
                <!-- Сводка заказа будет сгенерирована через JavaScript -->
            </div>

            <button class="btn btn-success" id="confirmBookingBtn" disabled>
                <i class="fas fa-check"></i> Подтвердить запись
            </button>
        </div>
    </div>

    <!-- Страница подтверждения -->
    <div class="page" id="confirmationPage">
        <div class="card">
            <h2 class="card-title"><i class="fas fa-check-circle"></i> Заявка оформлена</h2>

            <div class="alert alert-success">
                <i class="fas fa-check"></i> Ваша заявка успешно оформлена!
            </div>

            <div id="orderDetails">
                <!-- Детали заказа будут сгенерированы через JavaScript -->
            </div>

            <div class="text-center mt-4">
                <p>Вы получите уведомление за день до визита на склад.</p>
                <p>При себе необходимо иметь удостоверение личности.</p>
            </div>

            <button class="btn btn-primary mt-4" id="newRequestBtn">
                <i class="fas fa-plus"></i> Новая заявка
            </button>
        </div>
    </div>
</main>

<!-- Навигация (отображается после входа) -->
<nav class="app-nav hidden" id="appNav">
    <a href="#" class="nav-item active" data-page="inventoryPage">
        <i class="fas fa-boxes nav-icon"></i>
        <span class="nav-text">Наличие</span>
    </a>
    <a href="#" class="nav-item" data-page="selectionPage">
        <i class="fas fa-shopping-cart nav-icon"></i>
        <span class="nav-text">Выбор</span>
    </a>
    <a href="#" class="nav-item" data-page="bookingPage">
        <i class="fas fa-calendar-alt nav-icon"></i>
        <span class="nav-text">Запись</span>
    </a>
    <a href="#" class="nav-item" id="logoutBtn">
        <i class="fas fa-sign-out-alt nav-icon"></i>
        <span class="nav-text">Выход</span>
    </a>
</nav>

<script>
    // Данные для демонстрации
    const inventoryData = [
        { id: 1, name: "Куртка зимняя", category: "Верхняя одежда", size: "L", quantity: 15, color: "Синий" },
        { id: 2, name: "Куртка зимняя", category: "Верхняя одежда", size: "M", quantity: 8, color: "Синий" },
        { id: 3, name: "Куртка зимняя", category: "Верхняя одежда", size: "XL", quantity: 3, color: "Синий" },
        { id: 4, name: "Брюки рабочие", category: "Спецодежда", size: "44", quantity: 22, color: "Черный" },
        { id: 5, name: "Брюки рабочие", category: "Спецодежда", size: "42", quantity: 18, color: "Черный" },
        { id: 6, name: "Жилет защитный", category: "Спецодежда", size: "L", quantity: 12, color: "Оранжевый" },
        { id: 7, name: "Жилет защитный", category: "Спецодежда", size: "M", quantity: 7, color: "Оранжевый" },
        { id: 8, name: "Рубашка форма", category: "Форма", size: "M", quantity: 25, color: "Белый" },
        { id: 9, name: "Рубашка форма", category: "Форма", size: "L", quantity: 20, color: "Белый" },
        { id: 10, name: "Ботинки защитные", category: "Обувь", size: "42", quantity: 14, color: "Черный" },
        { id: 11, name: "Ботинки защитные", category: "Обувь", size: "44", quantity: 9, color: "Черный" },
        { id: 12, name: "Плащ дождевик", category: "Верхняя одежда", size: "L", quantity: 5, color: "Прозрачный" },
        { id: 13, name: "Перчатки рабочие", category: "Спецодежда", size: "M", quantity: 45, color: "Серый" },
        { id: 14, name: "Футболка", category: "Форма", size: "L", quantity: 32, color: "Синий" },
        { id: 15, name: "Футболка", category: "Форма", size: "M", quantity: 28, color: "Синий" }
    ];

    // Состояние приложения
    const state = {
        user: null,
        currentPage: 'loginPage',
        cart: [],
        procedureType: 'new', // 'new' или 'replacement'
        selectedDate: null,
        selectedTime: null,
        orderDetails: null
    };

    // DOM элементы
    const loginPage = document.getElementById('loginPage');
    const inventoryPage = document.getElementById('inventoryPage');
    const selectionPage = document.getElementById('selectionPage');
    const bookingPage = document.getElementById('bookingPage');
    const confirmationPage = document.getElementById('confirmationPage');

    const userInfo = document.getElementById('userInfo');
    const userAvatar = document.getElementById('userAvatar');
    const userName = document.getElementById('userName');
    const appNav = document.getElementById('appNav');

    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const showInventoryBtn = document.getElementById('showInventoryBtn');
    const addItemBtn = document.getElementById('addItemBtn');
    const newBtn = document.getElementById('newBtn');
    const replacementBtn = document.getElementById('replacementBtn');
    const toBookingBtn = document.getElementById('toBookingBtn');
    const confirmBookingBtn = document.getElementById('confirmBookingBtn');
    const newRequestBtn = document.getElementById('newRequestBtn');

    const categoryFilter = document.getElementById('categoryFilter');
    const sizeFilter = document.getElementById('sizeFilter');
    const inventoryGrid = document.getElementById('inventoryGrid');
    const cartItems = document.getElementById('cartItems');
    const calendar = document.getElementById('calendar');
    const timeSlots = document.getElementById('timeSlots');
    const bookingSummary = document.getElementById('bookingSummary');
    const orderDetails = document.getElementById('orderDetails');

    const navItems = document.querySelectorAll('.nav-item[data-page]');

    // Инициализация приложения
    document.addEventListener('DOMContentLoaded', function() {
        // Генерация инвентаря
        renderInventory();

        // Генерация календаря
        generateCalendar();

        // Генерация временных слотов
        generateTimeSlots();

        // Назначение обработчиков событий
        setupEventListeners();
    });

    // Назначение обработчиков событий
    function setupEventListeners() {
        // Вход в систему
        loginBtn.addEventListener('click', handleLogin);

        // Выход из системы
        logoutBtn.addEventListener('click', handleLogout);

        // Навигация
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                const pageId = this.getAttribute('data-page');
                navigateTo(pageId);

                // Обновление активного пункта навигации
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Кнопки на странице выбора
        showInventoryBtn.addEventListener('click', () => navigateTo('inventoryPage'));
        addItemBtn.addEventListener('click', showAddItemModal);
        newBtn.addEventListener('click', () => setProcedureType('new'));
        replacementBtn.addEventListener('click', () => setProcedureType('replacement'));
        toBookingBtn.addEventListener('click', () => navigateTo('bookingPage'));

        // Кнопки на странице записи
        confirmBookingBtn.addEventListener('click', confirmBooking);

        // Кнопка новой заявки
        newRequestBtn.addEventListener('click', startNewRequest);

        // Фильтры инвентаря
        categoryFilter.addEventListener('change', renderInventory);
        sizeFilter.addEventListener('change', renderInventory);
    }

    // Обработка входа
    function handleLogin() {
        const login = document.getElementById('login').value;
        const password = document.getElementById('password').value;

        // Простая проверка для демонстрации
        if (login === 'user' && password === '123') {
            state.user = {
                name: 'Иван Иванов',
                initials: 'ИИ',
                department: 'Отдел логистики'
            };

            // Показать информацию о пользователе
            userAvatar.textContent = state.user.initials;
            userName.textContent = state.user.name;
            userInfo.classList.remove('hidden');

            // Показать навигацию
            appNav.classList.remove('hidden');

            // Перейти на страницу инвентаря
            navigateTo('inventoryPage');

            // Установить активный пункт навигации
            navItems.forEach(nav => nav.classList.remove('active'));
            document.querySelector('.nav-item[data-page="inventoryPage"]').classList.add('active');
        } else {
            alert('Неверный логин или пароль. Для демонстрации используйте: Логин: user, Пароль: 123');
        }
    }

    // Обработка выхода
    function handleLogout(e) {
        e.preventDefault();
        state.user = null;
        state.cart = [];
        state.procedureType = 'new';
        state.selectedDate = null;
        state.selectedTime = null;
        state.orderDetails = null;

        // Скрыть информацию о пользователе и навигацию
        userInfo.classList.add('hidden');
        appNav.classList.add('hidden');

        // Перейти на страницу входа
        navigateTo('loginPage');

        // Очистить форму входа
        document.getElementById('login').value = '';
        document.getElementById('password').value = '';
    }

    // Навигация между страницами
    function navigateTo(pageId) {
        // Скрыть все страницы
        document.querySelectorAll('.page').forEach(page => {
            page.classList.remove('active');
        });

        // Показать выбранную страницу
        document.getElementById(pageId).classList.add('active');
        state.currentPage = pageId;

        // Обновить содержимое страниц при необходимости
        if (pageId === 'inventoryPage') {
            renderInventory();
        } else if (pageId === 'selectionPage') {
            renderCart();
            updateBookingButton();
        } else if (pageId === 'bookingPage') {
            renderBookingSummary();
            updateConfirmButton();
        } else if (pageId === 'confirmationPage') {
            renderOrderDetails();
        }
    }

    // Отображение инвентаря
    function renderInventory() {
        const category = categoryFilter.value;
        const size = sizeFilter.value;

        // Фильтрация данных
        let filteredData = inventoryData;
        if (category) {
            filteredData = filteredData.filter(item => item.category === category);
        }
        if (size) {
            filteredData = filteredData.filter(item => item.size === size);
        }

        // Очистка сетки
        inventoryGrid.innerHTML = '';

        // Заполнение сетки элементами инвентаря
        filteredData.forEach(item => {
            const itemElement = document.createElement('div');
            itemElement.className = 'inventory-item';
            itemElement.dataset.id = item.id;

            // Определение класса для количества
            let quantityClass = '';
            if (item.quantity <= 5) {
                quantityClass = 'low';
            } else if (item.quantity === 0) {
                quantityClass = 'out';
            }

            itemElement.innerHTML = `
                    <div class="item-name">${item.name}</div>
                    <div class="item-size">Размер: ${item.size}</div>
                    <div class="item-size">Цвет: ${item.color}</div>
                    <div class="item-quantity ${quantityClass}">${item.quantity} шт.</div>
                    <button class="btn btn-primary btn-block mt-2 add-to-cart-btn" style="padding: 8px 12px; font-size: 14px;">
                        <i class="fas fa-cart-plus"></i> В корзину
                    </button>
                `;

            inventoryGrid.appendChild(itemElement);
        });

        // Добавление обработчиков для кнопок "В корзину"
        document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const itemId = parseInt(this.closest('.inventory-item').dataset.id);
                addToCart(itemId);
            });
        });
    }

    // Добавление товара в корзину
    function addToCart(itemId) {
        const item = inventoryData.find(i => i.id === itemId);
        if (!item) return;

        // Проверка, есть ли уже такой товар в корзине
        const existingItem = state.cart.find(i => i.id === itemId);

        if (existingItem) {
            // Увеличить количество, если есть в наличии
            if (existingItem.quantity < item.quantity) {
                existingItem.quantity += 1;
            } else {
                alert(`Недостаточно товара на складе. Максимальное количество: ${item.quantity}`);
            }
        } else {
            // Добавить новый товар в корзину
            state.cart.push({
                ...item,
                quantity: 1,
                selectedQuantity: 1
            });
        }

        // Если мы на странице выбора, обновить корзину
        if (state.currentPage === 'selectionPage') {
            renderCart();
        }

        // Обновить кнопку перехода к записи
        updateBookingButton();

        // Показать уведомление
        showNotification(`Товар "${item.name}" добавлен в корзину`);
    }

    // Отображение корзины
    function renderCart() {
        if (state.cart.length === 0) {
            cartItems.innerHTML = `
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> Корзина пуста. Добавьте одежду из инвентаря.
                    </div>
                `;
            return;
        }

        let cartHTML = '';
        state.cart.forEach((item, index) => {
            cartHTML += `
                    <div class="cart-item">
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-details">Размер: ${item.size} | Цвет: ${item.color}</div>
                            <div class="cart-item-details">Доступно на складе: ${item.quantity} шт.</div>
                        </div>
                        <div class="cart-item-actions">
                            <div class="quantity-control">
                                <button class="quantity-btn decrease-quantity" data-index="${index}">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="quantity-value">${item.selectedQuantity}</span>
                                <button class="quantity-btn increase-quantity" data-index="${index}">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                            <button class="quantity-btn remove-item" data-index="${index}" style="color: #f44336;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
        });

        cartItems.innerHTML = cartHTML;

        // Добавление обработчиков для кнопок в корзине
        document.querySelectorAll('.decrease-quantity').forEach(btn => {
            btn.addEventListener('click', function() {
                const index = parseInt(this.dataset.index);
                decreaseQuantity(index);
            });
        });

        document.querySelectorAll('.increase-quantity').forEach(btn => {
            btn.addEventListener('click', function() {
                const index = parseInt(this.dataset.index);
                increaseQuantity(index);
            });
        });

        document.querySelectorAll('.remove-item').forEach(btn => {
            btn.addEventListener('click', function() {
                const index = parseInt(this.dataset.index);
                removeFromCart(index);
            });
        });
    }

    // Уменьшение количества товара в корзине
    function decreaseQuantity(index) {
        if (state.cart[index].selectedQuantity > 1) {
            state.cart[index].selectedQuantity -= 1;
            renderCart();
            updateBookingButton();
        }
    }

    // Увеличение количества товара в корзине
    function increaseQuantity(index) {
        const item = state.cart[index];
        if (item.selectedQuantity < item.quantity) {
            item.selectedQuantity += 1;
            renderCart();
            updateBookingButton();
        } else {
            alert(`Недостаточно товара на складе. Максимальное количество: ${item.quantity}`);
        }
    }

    // Удаление товара из корзины
    function removeFromCart(index) {
        const itemName = state.cart[index].name;
        state.cart.splice(index, 1);
        renderCart();
        updateBookingButton();
        showNotification(`Товар "${itemName}" удален из корзины`);
    }

    // Установка типа процедуры
    function setProcedureType(type) {
        state.procedureType = type;

        if (type === 'new') {
            newBtn.classList.remove('btn-secondary');
            newBtn.classList.add('btn-primary');
            replacementBtn.classList.remove('btn-primary');
            replacementBtn.classList.add('btn-secondary');
        } else {
            replacementBtn.classList.remove('btn-secondary');
            replacementBtn.classList.add('btn-primary');
            newBtn.classList.remove('btn-primary');
            newBtn.classList.add('btn-secondary');
        }
    }

    // Обновление состояния кнопки перехода к записи
    function updateBookingButton() {
        if (state.cart.length > 0) {
            toBookingBtn.disabled = false;
        } else {
            toBookingBtn.disabled = true;
        }
    }

    // Показ модального окна для добавления товара
    function showAddItemModal() {
        // В реальном приложении здесь было бы модальное окно
        // Для демонстрации просто переходим на страницу инвентаря
        navigateTo('inventoryPage');
    }

    // Генерация календаря
    function generateCalendar() {
        const today = new Date();
        const year = today.getFullYear();
        const month = today.getMonth();

        // Заголовки дней недели
        const dayNames = ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс'];

        let calendarHTML = '';

        // Заголовки дней недели
        dayNames.forEach(day => {
            calendarHTML += `<div class="calendar-header">${day}</div>`;
        });

        // Первый день месяца
        const firstDay = new Date(year, month, 1);
        // Последний день месяца
        const lastDay = new Date(year, month + 1, 0);

        // Пустые ячейки перед первым днем месяца
        for (let i = 0; i < firstDay.getDay(); i++) {
            calendarHTML += `<div class="calendar-day disabled"></div>`;
        }

        // Дни месяца
        for (let day = 1; day <= lastDay.getDate(); day++) {
            const currentDate = new Date(year, month, day);
            const isToday = day === today.getDate() && month === today.getMonth();
            const isPast = currentDate < today && !isToday;
            const isWeekend = currentDate.getDay() === 0 || currentDate.getDay() === 6;
            const isSelectable = !isPast && !isWeekend;

            let dayClass = 'calendar-day';
            if (isPast) dayClass += ' disabled';
            if (isToday) dayClass += ' today';
            if (isWeekend) dayClass += ' weekend';

            const dateStr = `${year}-${month+1}-${day}`;

            calendarHTML += `
                    <div class="${dayClass}" data-date="${dateStr}">
                        ${day}
                    </div>
                `;
        }

        calendar.innerHTML = calendarHTML;

        // Добавление обработчиков для выбора даты
        document.querySelectorAll('.calendar-day:not(.disabled)').forEach(day => {
            day.addEventListener('click', function() {
                // Сброс предыдущего выбора
                document.querySelectorAll('.calendar-day').forEach(d => {
                    d.classList.remove('selected');
                });

                // Установка нового выбора
                this.classList.add('selected');
                state.selectedDate = this.dataset.date;

                // Обновление сводки и кнопки подтверждения
                renderBookingSummary();
                updateConfirmButton();
            });
        });
    }

    // Генерация временных слотов
    function generateTimeSlots() {
        const slots = [
            '09:00', '10:00', '11:00', '12:00', '13:00',
            '14:00', '15:00', '16:00', '17:00'
        ];

        let slotsHTML = '';

        slots.forEach(slot => {
            slotsHTML += `
                    <div class="time-slot" data-time="${slot}">
                        ${slot}
                    </div>
                `;
        });

        timeSlots.innerHTML = slotsHTML;

        // Добавление обработчиков для выбора времени
        document.querySelectorAll('.time-slot').forEach(slot => {
            slot.addEventListener('click', function() {
                // Сброс предыдущего выбора
                document.querySelectorAll('.time-slot').forEach(s => {
                    s.classList.remove('selected');
                });

                // Установка нового выбора
                this.classList.add('selected');
                state.selectedTime = this.dataset.time;

                // Обновление сводки и кнопки подтверждения
                renderBookingSummary();
                updateConfirmButton();
            });
        });
    }

    // Отображение сводки бронирования
    function renderBookingSummary() {
        if (!state.selectedDate || !state.selectedTime || state.cart.length === 0) {
            bookingSummary.classList.add('hidden');
            return;
        }

        // Форматирование даты
        const date = new Date(state.selectedDate);
        const formattedDate = date.toLocaleDateString('ru-RU', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // Подсчет общего количества товаров
        const totalItems = state.cart.reduce((sum, item) => sum + item.selectedQuantity, 0);

        // Создание списка товаров
        let itemsList = '';
        state.cart.forEach(item => {
            itemsList += `<li>${item.name} (размер: ${item.size}) - ${item.selectedQuantity} шт.</li>`;
        });

        bookingSummary.innerHTML = `
                <h3>Сводка заявки</h3>
                <p><strong>Тип процедуры:</strong> <span class="status-badge status-${state.procedureType}">
                    ${state.procedureType === 'new' ? 'Получение новой' : 'Замена'}
                </span></p>
                <p><strong>Дата визита:</strong> ${formattedDate}</p>
                <p><strong>Время визита:</strong> ${state.selectedTime}</p>
                <p><strong>Количество позиций:</strong> ${state.cart.length}</p>
                <p><strong>Общее количество единиц:</strong> ${totalItems}</p>
                <p><strong>Состав заявки:</strong></p>
                <ul>${itemsList}</ul>
            `;

        bookingSummary.classList.remove('hidden');
    }

    // Обновление состояния кнопки подтверждения
    function updateConfirmButton() {
        if (state.selectedDate && state.selectedTime && state.cart.length > 0) {
            confirmBookingBtn.disabled = false;
        } else {
            confirmBookingBtn.disabled = true;
        }
    }

    // Подтверждение бронирования
    function confirmBooking() {
        // Создание деталей заказа
        state.orderDetails = {
            orderId: 'ORD-' + Date.now().toString().substr(-6),
            date: state.selectedDate,
            time: state.selectedTime,
            procedureType: state.procedureType,
            cart: [...state.cart],
            totalItems: state.cart.reduce((sum, item) => sum + item.selectedQuantity, 0),
            createdAt: new Date().toLocaleString('ru-RU')
        };

        // Переход на страницу подтверждения
        navigateTo('confirmationPage');

        // Сброс состояния корзины и выбора
        state.cart = [];
        state.selectedDate = null;
        state.selectedTime = null;

        // Сброс выбора в календаре и временных слотах
        document.querySelectorAll('.calendar-day').forEach(d => d.classList.remove('selected'));
        document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
    }

    // Отображение деталей заказа
    function renderOrderDetails() {
        if (!state.orderDetails) return;

        // Форматирование даты
        const date = new Date(state.orderDetails.date);
        const formattedDate = date.toLocaleDateString('ru-RU', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // Создание списка товаров
        let itemsList = '';
        state.orderDetails.cart.forEach(item => {
            itemsList += `<li>${item.name} (размер: ${item.size}) - ${item.selectedQuantity} шт.</li>`;
        });

        orderDetails.innerHTML = `
                <p><strong>Номер заявки:</strong> ${state.orderDetails.orderId}</p>
                <p><strong>Тип процедуры:</strong> <span class="status-badge status-${state.orderDetails.procedureType}">
                    ${state.orderDetails.procedureType === 'new' ? 'Получение новой' : 'Замена'}
                </span></p>
                <p><strong>Дата визита:</strong> ${formattedDate}</p>
                <p><strong>Время визита:</strong> ${state.orderDetails.time}</p>
                <p><strong>Общее количество единиц:</strong> ${state.orderDetails.totalItems}</p>
                <p><strong>Состав заявки:</strong></p>
                <ul>${itemsList}</ul>
                <p><strong>Заявка создана:</strong> ${state.orderDetails.createdAt}</p>
            `;
    }

    // Начало новой заявки
    function startNewRequest() {
        // Сброс состояния
        state.cart = [];
        state.procedureType = 'new';
        state.selectedDate = null;
        state.selectedTime = null;
        state.orderDetails = null;

        // Сброс выбора типа процедуры
        setProcedureType('new');

        // Переход на страницу выбора
        navigateTo('selectionPage');

        // Обновление активного пункта навигации
        navItems.forEach(nav => nav.classList.remove('active'));
        document.querySelector('.nav-item[data-page="selectionPage"]').classList.add('active');
    }

    // Показ уведомления
    function showNotification(message) {
        // В реальном приложении здесь можно использовать более сложную систему уведомлений
        console.log(message);
    }
</script>
</body>
</html>